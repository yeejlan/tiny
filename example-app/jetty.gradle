
def runWithWeaver = true
def runWithHotSwap = false
def tinyAppEnv = "development"

task "JettyRun"(type: JavaExec){

	if(runWithWeaver) {
		def weaver = configurations.ajweaver.asPath
		jvmArgs = jvmArgs << "-javaagent:$weaver"
	}
	if(runWithHotSwap){
		jvmArgs = jvmArgs << "-XXaltjvm=dcevm"
		jvmArgs = jvmArgs << "-javaagent:c:/tools/hotswap-agent.jar"
	}
	jvmArgs = jvmArgs << "-Dtiny.app.env=$tinyAppEnv"

	classpath = sourceSets.main.runtimeClasspath

	main = 'example.JettyRunKt'
}

task "jr"(dependsOn: JettyRun)